<?xml version="1.0" encoding="UTF-8"?>

<connector xmlns="http://geronimo.apache.org/xml/ns/j2ee/connector"
    version="1.5"
    configId="org/apache/geronimo/DefaultDatabase"
    parentId="org/apache/geronimo/Server">

    <dependency>
        <uri>org.apache.derby/jars/derby-${derby_version}.jar</uri>
    </dependency>
    <dependency>
        <uri>org.apache.derby/jars/derbynet-${derby_version}.jar</uri>
    </dependency>

    <dependency>
        <uri>commons-collections/jars/commons-collections-${commons_collections_version}.jar</uri>
    </dependency>

    <dependency>
        <uri>commons-primitives/jars/commons-primitives-${commons_primitives_version}.jar</uri>
    </dependency>

    <dependency>
        <uri>regexp/jars/regexp-${regexp_version}.jar</uri>
    </dependency>

    <dependency>
        <uri>geronimo/jars/geronimo-derby-${geronimo_version}.jar</uri>
    </dependency>

    <resourceadapter>
        <outbound-resourceadapter>
            <connection-definition>
                <connectionfactory-interface>javax.sql.DataSource</connectionfactory-interface>
                <connectiondefinition-instance>
                    <name>DefaultDatasource</name>
                    <config-property-setting name="UserName"></config-property-setting>
                    <config-property-setting name="Password"></config-property-setting>
                    <config-property-setting name="DatabaseName">DefaultDatasource</config-property-setting>
                    <config-property-setting name="CreateDatabase">create</config-property-setting>
                    <connectionmanager>
                        <single-pool>
                            <match-one/>
                        </single-pool>
                    </connectionmanager>
                </connectiondefinition-instance>
            </connection-definition>
        </outbound-resourceadapter>
    </resourceadapter>

    <gbean name="DerbySystem" class="org.apache.geronimo.derby.DerbySystemGBean">
        <reference name="ServerInfo"><moduleType>J2EEModule</moduleType><module>org/apache/geronimo/System</module><name>ServerInfo</name></reference>
        <attribute name="derbySystemHome">var/derby</attribute>
    </gbean>
    <gbean name="DerbyNetwork" class="org.apache.geronimo.derby.DerbyNetworkGBean">
        <!--TODO remove moduleType when gbeans get the moduleType of the plan they are in -->
        <reference name="derbySystem"><moduleType>J2EEModule</moduleType><name>DerbySystem</name></reference>
        <attribute name="host">127.0.0.1</attribute>
        <attribute name="port">1527</attribute>
    </gbean>

    <gbean name="JDBCTransactionalThreadPooledTimer" class="org.apache.geronimo.timer.jdbc.JDBCStoreThreadPooledTransactionalTimer">
        <attribute name="repeatCount">5</attribute>
        <reference name="TransactionContextManager"><moduleType>J2EEModule</moduleType><module>org/apache/geronimo/Server</module><name>TransactionContextManager</name></reference>
        <reference name="ManagedConnectionFactoryWrapper"><moduleType>JCAResource</moduleType><name>DefaultDatasource</name></reference>
        <reference name="ThreadPool"><moduleType>J2EEModule</moduleType><module>org/apache/geronimo/Server</module><name>DefaultThreadPool</name></reference>
        <!--TODO remove moduleType when gbeans get the moduleType of the plan they are in -->
        <reference name="DerbySystem"><moduleType>J2EEModule</moduleType><name>DerbySystem</name></reference>
    </gbean>

    <gbean name="JDBCNonTransactionalThreadPooledTimer" class="org.apache.geronimo.timer.jdbc.JDBCStoreThreadPooledNonTransactionalTimer">
        <reference name="TransactionContextManager"><moduleType>J2EEModule</moduleType><module>org/apache/geronimo/Server</module><name>TransactionContextManager</name></reference>
        <reference name="ManagedConnectionFactoryWrapper"><moduleType>JCAResource</moduleType><name>DefaultDatasource</name></reference>
        <reference name="ThreadPool"><moduleType>J2EEModule</moduleType><module>org/apache/geronimo/Server</module><name>DefaultThreadPool</name></reference>
        <!--TODO remove moduleType when gbeans get the moduleType of the plan they are in -->
        <reference name="DerbySystem"><moduleType>J2EEModule</moduleType><name>DerbySystem</name></reference>
    </gbean>

</connector>

<?xml version="1.0"?>

<openejb-jar
    xmlns="http://www.openejb.org/xml/ns/openejb-jar"
    xmlns:sec="http://geronimo.apache.org/xml/ns/security"
    configId="org/openejb/scenario001"
    parentId="org/openejb/Security">

    <dependency>
        <uri>junit/jars/junit-3.8.1.jar</uri>
    </dependency>

    <enterprise-beans>
        <!--
        ########################################################
        Stateless
        ########################################################
        -->
        <session>
            <ejb-name>BasicStatelessBean</ejb-name>
            <jndi-name>security/001/BasicStatelessHome</jndi-name>
        </session>

    </enterprise-beans>

    <sec:security default-role="UNASSIGNED" doas-current-caller="true">
        <sec:default-principal realm-name="public-properties-realm">
            <sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoUserPrincipal" name="guest"/>
        </sec:default-principal>

        <sec:role-mappings>
            <sec:role role-name="UNASSIGNED">
                <sec:realm realm-name="public-properties-realm">
                    <sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoUserPrincipal" name="guest" designated-run-as="true"/>
                </sec:realm>
            </sec:role>

            <sec:role role-name="LOW">
                <sec:realm realm-name="public-properties-realm">
                    <sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoGroupPrincipal" name="acct" designated-run-as="true"/>
                </sec:realm>
            </sec:role>

            <sec:role role-name="MEDIUM">
                <sec:realm realm-name="public-properties-realm">
                    <sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoGroupPrincipal" name="it"/>
                    <sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoUserPrincipal" name="george" designated-run-as="true"/>
                </sec:realm>
            </sec:role>

            <sec:role role-name="HIGH">
                <sec:realm realm-name="public-properties-realm">
                    <sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoGroupPrincipal" name="mgmt" designated-run-as="true"/>
                </sec:realm>
                <sec:realm realm-name="black-properties-realm">
                    <sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoUserPrincipal" name="dain"/>
                    <sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoUserPrincipal" name="david"/>
                </sec:realm>
            </sec:role>
        </sec:role-mappings>
    </sec:security>

</openejb-jar>